(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Lvw3:function(e,t,r){"use strict";r.r(t),r.d(t,"ProfileModule",(function(){return T}));var a=r("tyNb"),i=r("fXoL"),o=r("wZkO");let s=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(a.b))},e.\u0275cmp=i.Gb({type:e,selectors:[["app-profile-dashboard"]],decls:4,vars:2,consts:[["mat-tab-nav-bar",""],["mat-tab-link","",3,"routerLink","active"]],template:function(e,t){1&e&&(i.Sb(0,"nav",0),i.Sb(1,"a",1),i.Ac(2,"Profile"),i.Rb(),i.Rb(),i.Nb(3,"router-outlet")),2&e&&(i.Bb(1),i.kc("routerLink","index")("active",t.router.url.endsWith("index")))},directives:[o.b,a.c,o.a,a.e],styles:[""]}),e})();var n=r("3Pt+"),c=r("FKr1"),l=r("wd/R");const d=r.n(l).a||l,u=new i.s("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function(){return{useUtc:!1}}});function b(e,t){const r=Array(e);for(let a=0;a<e;a++)r[a]=t(a);return r}let f=(()=>{class e extends c.c{constructor(e,t){super(),this._options=t,this.setLocale(e||d.locale())}setLocale(e){super.setLocale(e);let t=d.localeData(e);this._localeData={firstDayOfWeek:t.firstDayOfWeek(),longMonths:t.months(),shortMonths:t.monthsShort(),dates:b(31,e=>this.createDate(2017,0,e+1).format("D")),longDaysOfWeek:t.weekdays(),shortDaysOfWeek:t.weekdaysShort(),narrowDaysOfWeek:t.weekdaysMin()}}getYear(e){return this.clone(e).year()}getMonth(e){return this.clone(e).month()}getDate(e){return this.clone(e).date()}getDayOfWeek(e){return this.clone(e).day()}getMonthNames(e){return"long"==e?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(e){return"long"==e?this._localeData.longDaysOfWeek:"short"==e?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(e){return this.clone(e).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(e){return this.clone(e).daysInMonth()}clone(e){return e.clone().locale(this.locale)}createDate(e,t,r){const a=this._createMoment({year:e,month:t,date:r}).locale(this.locale);return a.isValid(),a}today(){return this._createMoment().locale(this.locale)}parse(e,t){return e&&"string"==typeof e?this._createMoment(e,t,this.locale):e?this._createMoment(e).locale(this.locale):null}format(e,t){return e=this.clone(e),this.isValid(e),e.format(t)}addCalendarYears(e,t){return this.clone(e).add({years:t})}addCalendarMonths(e,t){return this.clone(e).add({months:t})}addCalendarDays(e,t){return this.clone(e).add({days:t})}toIso8601(e){return this.clone(e).format()}deserialize(e){let t;if(e instanceof Date)t=this._createMoment(e).locale(this.locale);else if(this.isDateInstance(e))return this.clone(e);if("string"==typeof e){if(!e)return null;t=this._createMoment(e,d.ISO_8601).locale(this.locale)}return t&&this.isValid(t)?this._createMoment(t).locale(this.locale):super.deserialize(e)}isDateInstance(e){return d.isMoment(e)}isValid(e){return this.clone(e).isValid()}invalid(){return d.invalid()}_createMoment(e,t,r){const{strict:a,useUtc:i}=this._options||{};return i?d.utc(e,t,r,a):d(e,t,r,a)}}return e.\u0275fac=function(t){return new(t||e)(i.Wb(c.f,8),i.Wb(u,8))},e.\u0275prov=i.Ib({token:e,factory:e.\u0275fac}),e})();const h={parse:{dateInput:"LL"},display:{dateInput:"D MMMM YYYY",monthYearLabel:"YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"YYYY"}};var p=r("AytR"),m=r("tk/3"),y=r("1q3R");let g=(()=>{class e{constructor(e,t){this.http=e,this.authService=t,this.editProfile=(e,t)=>this.http.patch(`${p.a.backendUrl}/users/edit-profile/${e}`,{newData:t},{headers:this.authService.addAuthorizedHeader()})}}return e.\u0275fac=function(t){return new(t||e)(i.Wb(m.b),i.Wb(y.a))},e.\u0275prov=i.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=r("0IaG"),k=r("dNgK"),S=r("XiUz"),x=r("kmnG"),M=r("qFsG"),R=r("iadO"),A=r("ofXK"),D=r("bTqV");function O(e,t){1&e&&(i.Sb(0,"mat-error"),i.Ac(1," DoB is required "),i.Rb())}function B(e,t){1&e&&(i.Sb(0,"mat-error"),i.Ac(1," Job title is required "),i.Rb())}function w(e,t){1&e&&(i.Sb(0,"mat-error"),i.Ac(1," Address is required "),i.Rb())}let P=(()=>{class e{constructor(e,t,r,a,i){this.formBuilder=e,this.profileService=t,this.dialogRef=r,this.snackBar=a,this.authService=i}ngOnInit(){this.editProfileForm=this.formBuilder.group({jobTitle:[this.user.jobTitle,[n.s.required]],dateOfBirth:[new Date(this.user.dateOfBirth),[n.s.required]],address:[this.user.address,[n.s.required]]})}submit(){if(this.editProfileForm.valid){let e={jobTitle:this.editProfileForm.value.jobTitle,dateOfBirth:{date:this.editProfileForm.value.dateOfBirth.date(),month:this.editProfileForm.value.dateOfBirth.month(),year:this.editProfileForm.value.dateOfBirth.year()},address:this.editProfileForm.value.address};this.profileService.editProfile(this.user._id,e).subscribe(e=>{e.success?(this.authService.userSubject.next(e.user),this.snackBar.open("Profile edited successfully","Close",{duration:2e3,panelClass:["success-snackbar"],horizontalPosition:"end"}),this.dialogRef.close()):this.snackBar.open(e.msg,"Close",{duration:2e3,panelClass:["error-snackbar"],horizontalPosition:"end"})})}}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(n.d),i.Mb(g),i.Mb(v.c),i.Mb(k.a),i.Mb(y.a))},e.\u0275cmp=i.Gb({type:e,selectors:[["app-edit-profile"]],inputs:{user:"user"},features:[i.Ab([{provide:c.c,useClass:f,deps:[c.f]},{provide:c.e,useValue:h}])],decls:25,vars:6,consts:[["fxFill","","fxLayoutAlign","center center"],["fxLayout","column","fxFlex","100%","fxFlex.gt-md","70%",3,"formGroup","ngSubmit"],["appearance","standard"],["matInput","","formControlName","dateOfBirth",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["matInput","","formControlName","jobTitle","type","text"],["matInput","","formControlName","address","type","text"],["fxLayoutAlign","center"],["mat-raised-button","","color","primary","type","submit"]],template:function(e,t){if(1&e&&(i.Sb(0,"div",0),i.Sb(1,"form",1),i.ac("ngSubmit",(function(){return t.submit()})),i.Sb(2,"h2"),i.Ac(3,"Edit profile"),i.Rb(),i.Sb(4,"mat-form-field",2),i.Sb(5,"mat-label"),i.Ac(6,"Date of birth"),i.Rb(),i.Nb(7,"input",3),i.Nb(8,"mat-datepicker-toggle",4),i.Nb(9,"mat-datepicker",null,5),i.zc(11,O,2,0,"mat-error",6),i.Rb(),i.Sb(12,"mat-form-field",2),i.Sb(13,"mat-label"),i.Ac(14,"Job title"),i.Rb(),i.Nb(15,"input",7),i.zc(16,B,2,0,"mat-error",6),i.Rb(),i.Sb(17,"mat-form-field",2),i.Sb(18,"mat-label"),i.Ac(19,"Address"),i.Rb(),i.Nb(20,"input",8),i.zc(21,w,2,0,"mat-error",6),i.Rb(),i.Sb(22,"div",9),i.Sb(23,"button",10),i.Ac(24,"Submit"),i.Rb(),i.Rb(),i.Rb(),i.Rb()),2&e){const e=i.pc(10);i.Bb(1),i.kc("formGroup",t.editProfileForm),i.Bb(6),i.kc("matDatepicker",e),i.Bb(1),i.kc("for",e),i.Bb(3),i.kc("ngIf",t.editProfileForm.get("dateOfBirth").hasError("required")),i.Bb(5),i.kc("ngIf",t.editProfileForm.get("jobTitle").hasError("required")),i.Bb(5),i.kc("ngIf",t.editProfileForm.get("address").hasError("required"))}},directives:[S.e,S.b,n.t,n.n,S.c,S.a,n.h,x.c,x.f,M.b,n.c,R.b,n.m,n.g,R.d,x.g,R.a,A.m,D.b,x.b],styles:[""]}),e})();var _=r("qUOr"),L=r("f0Cb"),I=r("NFeN");function N(e,t){if(1&e){const e=i.Tb();i.Sb(0,"div",12),i.Sb(1,"div"),i.Ac(2,"Your account has not been approved. Please contact your manager"),i.Rb(),i.Sb(3,"mat-icon",13),i.ac("click",(function(){return i.rc(e),i.ec(2).closeAlert()})),i.Ac(4,"close"),i.Rb(),i.Rb()}}function Y(e,t){if(1&e){const e=i.Tb();i.Sb(0,"div",1),i.Sb(1,"div",2),i.Nb(2,"img",3),i.Sb(3,"div",4),i.Sb(4,"div",5),i.Ac(5),i.Rb(),i.Sb(6,"div",6),i.Ac(7),i.Rb(),i.Rb(),i.Rb(),i.Nb(8,"mat-divider"),i.Sb(9,"div",7),i.Sb(10,"div",8),i.Sb(11,"mat-icon"),i.Ac(12,"email"),i.Rb(),i.Sb(13,"div"),i.Ac(14),i.Rb(),i.Rb(),i.Sb(15,"div",8),i.Sb(16,"mat-icon"),i.Ac(17,"cake"),i.Rb(),i.Sb(18,"div"),i.Ac(19),i.Rb(),i.Rb(),i.Sb(20,"div",8),i.Sb(21,"mat-icon"),i.Ac(22,"location_city"),i.Rb(),i.Sb(23,"div"),i.Ac(24),i.Rb(),i.Rb(),i.Sb(25,"div",9),i.Sb(26,"a",10),i.ac("click",(function(){return i.rc(e),i.ec().editProfile()})),i.Ac(27,"Edit Profile"),i.Rb(),i.Rb(),i.zc(28,N,5,0,"div",11),i.Rb(),i.Rb()}if(2&e){const e=i.ec();i.Bb(2),i.kc("src",e.user.profilePicUrl||"./assets/default_avatar.png",i.sc),i.Bb(3),i.Bc(e.user.name),i.Bb(2),i.Bc(e.user.jobTitle||e.user.role),i.Bb(7),i.Bc(e.user.email),i.Bb(5),i.Bc(e.user.dateOfBirth||"Not set yet"),i.Bb(5),i.Bc(e.user.address||"Not set yet"),i.Bb(4),i.kc("ngIf",!e.user.approved&&e.showAlert)}}const C=[{path:"",component:s,children:[{path:"index",component:(()=>{class e{constructor(e,t){this.authService=e,this.dialog=t,this.showAlert=!0,this.closeAlert=()=>this.showAlert=!1,this.editProfile=()=>{this.dialog.open(P,{width:"500px"}).componentInstance.user=this.user}}ngOnInit(){this.authService.userSubject.subscribe(e=>{this.user=e,e&&this.user.dateOfBirth&&(this.user.dateOfBirth=new A.e("en-GB").transform(new Date(this.user.dateOfBirth.year,this.user.dateOfBirth.month,this.user.dateOfBirth.date),"d MMMM yyyy"))})}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(y.a),i.Mb(v.a))},e.\u0275cmp=i.Gb({type:e,selectors:[["app-display-profile"]],features:[i.Ab([{provide:c.c,useClass:f,deps:[c.f]},{provide:c.e,useValue:h}])],decls:1,vars:1,consts:[["fxFlex","","style","padding: 40px",4,"appLoading"],["fxFlex","",2,"padding","40px"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","start end",2,"margin-bottom","20px"],["alt","Profile pic",1,"profile-pic",3,"src"],["fxLayout","column"],[1,"name"],[1,"job-title"],["fxLayout","column","fxLayoutGap","30px",2,"padding-top","30px"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start end"],["fxLayoutAlign","start"],["mat-raised-button","","color","primary",3,"click"],["class","alert mat-elevation-z8",4,"ngIf"],[1,"alert","mat-elevation-z8"],[1,"clickable",3,"click"]],template:function(e,t){1&e&&i.zc(0,Y,29,7,"div",0),2&e&&i.kc("appLoading",!t.user)},directives:[_.a,S.a,S.c,S.d,S.b,L.a,I.a,D.a,A.m],styles:[".profile-pic[_ngcontent-%COMP%]{width:120px;height:120px}.name[_ngcontent-%COMP%]{font-size:40px;font-weight:700}.job-title[_ngcontent-%COMP%]{font-size:15px}.alert[_ngcontent-%COMP%]{background-color:rgba(240,67,54,.8);padding:20px;color:#fff;margin-bottom:15px;display:flex;flex-direction:row;justify-content:space-between;align-content:center}.clickable[_ngcontent-%COMP%]{cursor:pointer}"]}),e})()},{path:"",pathMatch:"full",redirectTo:"index"},{path:"**",component:r("QdL7").a}]}];let F=(()=>{class e{}return e.\u0275mod=i.Kb({type:e}),e.\u0275inj=i.Jb({factory:function(t){return new(t||e)},imports:[[a.d.forChild(C)],a.d]}),e})();var W=r("PCNd");let T=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=i.Kb({type:e}),e.\u0275inj=i.Jb({factory:function(t){return new(t||e)},imports:[[W.a.forRoot(),F]]}),e})()}}]);